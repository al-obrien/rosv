<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rosv">
<title>Introduction to rosv • rosv</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to rosv">
<meta property="og:description" content="rosv">
<meta property="og:image" content="https://al-obrien.github.io/rosv/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rosv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/rosv.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/al-obrien/rosv/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to rosv</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/al-obrien/rosv/blob/HEAD/vignettes/rosv.Rmd" class="external-link"><code>vignettes/rosv.Rmd</code></a></small>
      <div class="d-none name"><code>rosv.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="package-purpose">Package purpose<a class="anchor" aria-label="anchor" href="#package-purpose"></a>
</h2>
<p>The {rosv} package provides two core purposes:</p>
<ul>
<li>Access information from the <a href="https://osv.dev/" class="external-link">Open Source
Vulnerability (OSV) database</a>.</li>
<li>Operate on vulnerability information and create formatted lists for
package administration.</li>
</ul>
<p>Consequently, the functions in {rosv} relate to querying or
downloading content from OSV, parsing JSON content, and generating
tables and lists regarding key information on package vulnerabilities.
The OSV database is not specific to R related repositories such as CRAN;
users can access information on any ecosystem available in OSV. For R
users who also dabble in Python, they can search for package
vulnerabilities within the PyPI repository while remaining in an R
interface.</p>
</div>
<div class="section level2">
<h2 id="basic-examples">Basic Examples<a class="anchor" aria-label="anchor" href="#basic-examples"></a>
</h2>
<p>The following examples will outline an assortment of package
functionality but first we must load the package!</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://al-obrien.github.io/rosv/">rosv</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="detect-vulnerable-packages">Detect vulnerable packages<a class="anchor" aria-label="anchor" href="#detect-vulnerable-packages"></a>
</h3>
<p>One of the simplest queries is to provide a package and ecosystem and
return a <code>TRUE</code>/<code>FALSE</code> response informing you if
that package has ever been listed with a vulnerability.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is_pkg_vulnerable.html">is_pkg_vulnerable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dask'</span>, <span class="st">'dash'</span><span class="op">)</span>, ecosystem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PyPI'</span>, <span class="st">'PyPI'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  dask  dash </span></span>
<span><span class="co">#&gt;  TRUE FALSE</span></span></code></pre>
<p>The number of vulnerabilities detected for each package can also be
queried.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/osv_count_vulns.html">osv_count_vulns</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dask'</span>, <span class="st">'readxl'</span>, <span class="st">'dplyr'</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PyPI'</span>, <span class="st">'CRAN'</span>, <span class="st">'CRAN'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;   dask readxl  dplyr </span></span>
<span><span class="co">#&gt;      1      3      0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="list-package-vulnerabilities">List package vulnerabilities<a class="anchor" aria-label="anchor" href="#list-package-vulnerabilities"></a>
</h3>
<p>The most basic usage of {rosv} is to pull all versions of an
ecosystem’s packages (e.g. PyPI or CRAN) listed in the OSV database.
This can be achieved using high-level functions such as
<code><a href="../reference/osv_query.html">osv_query()</a></code> and <code><a href="../reference/create_osv_list.html">create_osv_list()</a></code>.</p>
<p>To start we can query one package in PyPI for vulnerabilities.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkg_vul</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/osv_query.html">osv_query</a></span><span class="op">(</span><span class="st">'dask'</span>, ecosystem <span class="op">=</span> <span class="st">'PyPI'</span>, all_affected <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Use the OSV query to generate a sorted and de-duplicated list of just
package name and version.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkg_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_osv_list.html">create_osv_list</a></span><span class="op">(</span><span class="va">pkg_vul</span>, as.data.frame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pkg_tbl</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;   name versions</span></span>
<span><span class="co">#&gt; 1 dask   0.10.0</span></span>
<span><span class="co">#&gt; 2 dask   0.10.1</span></span>
<span><span class="co">#&gt; 3 dask   0.10.2</span></span></code></pre>
<p>Pull the entire set of PyPI vulnerability data and de-duplicate</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkg_vul</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/osv_query.html">osv_query</a></span><span class="op">(</span>ecosystem <span class="op">=</span> <span class="st">'PyPI'</span>, all_affected <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pypi_vul</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_osv_list.html">create_osv_list</a></span><span class="op">(</span><span class="va">pkg_vul</span>, as.data.frame <span class="op">=</span> <span class="cn">FALSE</span>, NA_value <span class="op">=</span> <span class="st">' '</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pypi_vul</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "aaiohttp\t "           "accesscontrol\t2.13.0" "accesscontrol\t2.13.1"</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="scan-an-r-project">Scan an R project<a class="anchor" aria-label="anchor" href="#scan-an-r-project"></a>
</h2>
<p>Packages discovered within an R project (such as {renv} LOCK files
and installed packages at <code><a href="https://rdrr.io/r/base/libPaths.html" class="external-link">.libPaths()</a></code>) can be parsed and
scanned directly using <code><a href="../reference/osv_scan.html">osv_scan()</a></code>. A
<code>data.frame</code> is returned with the package name and a logical
value specifying if a vulnerability was discovered in the OSV database.
If a particular scanning mode does not exist, similar functionality can
be created if a package list and associated version information is
passed to <code><a href="../reference/is_pkg_vulnerable.html">is_pkg_vulnerable()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/osv_scan.html">osv_scan</a></span><span class="op">(</span><span class="st">'r_project'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;         name version ecosystem is_vul</span></span>
<span><span class="co">#&gt; 1 commonmark   1.9.0      CRAN   TRUE</span></span>
<span><span class="co">#&gt; 2   jsonlite   1.8.7      CRAN   TRUE</span></span>
<span><span class="co">#&gt; 3    askpass   1.2.0      CRAN  FALSE</span></span>
<span><span class="co">#&gt; 4       base   4.3.1      CRAN  FALSE</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="use-api-helpers-directly">Use API helpers directly<a class="anchor" aria-label="anchor" href="#use-api-helpers-directly"></a>
</h2>
<p>Lower-level functions return more detail about the API request and
response contained within the R6 object. These are more flexible than
their higher-level alternatives. By default, the results of these
functions will be cached. This can be overriden by specifying
<code>cache = FALSE</code>.</p>
<p>The higher-level API query function <code><a href="../reference/osv_query.html">osv_query()</a></code> builds
upon these helpers to align the format of returned content, making it
the preferred choice for typical use-cases.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Returns entire response object to parse as you please.</span></span>
<span><span class="fu"><a href="../reference/osv_query_1.html">osv_query_1</a></span><span class="op">(</span><span class="st">'dask'</span>, ecosystem <span class="op">=</span> <span class="st">'PyPI'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Returns the vulnerability IDs for packages in list</span></span>
<span><span class="fu"><a href="../reference/osv_querybatch.html">osv_querybatch</a></span><span class="op">(</span><span class="st">'dask'</span>, ecosystem <span class="op">=</span> <span class="st">'PyPI'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Return vulnerabilities from different ecosystems as vectors</span></span>
<span><span class="fu"><a href="../reference/osv_querybatch.html">osv_querybatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dask'</span>, <span class="st">'readxl'</span><span class="op">)</span>, ecosystem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PyPI'</span>, <span class="st">'CRAN'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Grab details by vulns ID</span></span>
<span><span class="fu"><a href="../reference/osv_vulns.html">osv_vulns</a></span><span class="op">(</span><span class="st">'PYSEC-2021-387'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download vulns for an ecosystem</span></span>
<span><span class="fu"><a href="../reference/osv_download.html">osv_download</a></span><span class="op">(</span><span class="st">'PYSEC-2021-387'</span>, <span class="st">'PyPI'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/osv_download.html">osv_download</a></span><span class="op">(</span>ecosystem <span class="op">=</span> <span class="st">'PyPI'</span>, download_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="result-caching">Result caching<a class="anchor" aria-label="anchor" href="#result-caching"></a>
</h2>
<p>By default, results from queries using API helpers
(e.g. <code><a href="../reference/osv_query.html">osv_query()</a></code> or <code><a href="../reference/osv_querybatch.html">osv_querybatch()</a></code>) will
cache results using <code><a href="https://memoise.r-lib.org/reference/memoise.html" class="external-link">memoise::memoise()</a></code>. The caching can be
turned off directly using function parameters or globally reset using
<code><a href="../reference/clear_osv_cache.html">clear_osv_cache()</a></code>. Caching is the default behavior to help
enforce polite access of the OSV API. When clearing the cache, all
vulnerability files saved to disk at the temporary R session location
will also be removed (refer to the environment variable
<code>ROSV_CACHE_GLOBAL</code>).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Query without caching</span></span>
<span><span class="fu"><a href="../reference/osv_query.html">osv_query</a></span><span class="op">(</span><span class="st">'dask'</span>, ecosystem <span class="op">=</span> <span class="st">'PyPI'</span>, cache <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># File will be saved to disk</span></span>
<span><span class="fu"><a href="../reference/osv_download.html">osv_download</a></span><span class="op">(</span><span class="st">'PYSEC-2021-387'</span>, <span class="st">'PyPI'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clear cache, as needed</span></span>
<span><span class="fu"><a href="../reference/clear_osv_cache.html">clear_osv_cache</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-a-cross-referenced-whitelist">Creating a cross-referenced whitelist<a class="anchor" aria-label="anchor" href="#creating-a-cross-referenced-whitelist"></a>
</h2>
<p>When using a product such as {miniCRAN} or Posit Package Manager
there may be corporate requirements to limit what packages users can
install. Although having a whitelist is often recommended, it should
either specify the exact versions that are approved or exclude packages
with known vulnerabilities. Given the sheer amount of packages and their
versions, this is often difficult. The following method will take a
vector of packages (from PyPI) and cross-reference against the OSV
database. If packages are identified they are either entirely dropped,
or the specific versions with flagged vulnerabilities are excluded.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List of packages of interest</span></span>
<span><span class="va">python_pkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dask'</span>, <span class="st">'dash'</span>, <span class="st">'keras'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the xref whitelist</span></span>
<span><span class="va">xref_pkg_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_xref_whitelist.html">create_xref_whitelist</a></span><span class="op">(</span><span class="va">python_pkg</span>,</span>
<span>                                       ecosystem <span class="op">=</span> <span class="st">'PyPI'</span>,</span>
<span>                                       output_format <span class="op">=</span> <span class="st">'requirements.txt'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output requirements.txt which can be used with PPM product</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">xref_pkg_list</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'requirements.txt'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Allen OBrien.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
